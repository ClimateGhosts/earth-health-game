(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(9331)}])},9331:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return pages}});var a,r,o,n,l,i,c=s(5893),m=s(7294),d=s(5005),u=s(8837),h=s(1555),p=s(682),x=s(4747),g=s(4490),j=s(2960),_=s(2749),y=s(4486),v=s(2914),f=s(4449),N=s(4051),E=s(2599),Z=s(8817),b=s(1978),w=s(1143),C=s(1515),F=s(5386),k=s(9578),A=s(9019),O=s(5378),indicator=e=>{let{status:t}=e;return!0===t?(0,c.jsx)(k.Z,{color:"green"}):!1===t?(0,c.jsx)(A.Z,{color:"red"}):(0,c.jsx)(O.Z,{color:"orange"})},R=s(6486),T=s.n(R);let G=(0,m.createContext)({socket:void 0,serverUrl:"https://earth-health-game.appmana.com",isConnected:!1,myRoles:[]}),createSocket=e=>{let t=(0,E.io)(e);return t.url=e,t},getOptionValue=(e,t)=>{switch(e.type){case"str":return String(t);case"bool":return!!t;case"int":return"string"==typeof t?parseInt(t):Number(t);case"float":return"string"==typeof t?parseFloat(t):Number(t)}},SocketIOCommon=e=>{let{children:t,title:s}=e,[a,r]=(0,Z.Z)("serverUrl","https://earth-health-game.appmana.com"),[o,n]=(0,m.useState)(()=>createSocket(a)),[l,i]=(0,m.useState)(null),[E,k]=(0,Z.Z)("username","Client"),[A,O]=(0,m.useState)([]),[R,I]=(0,b.Z)(new Set([])),[S,L]=(0,m.useState)(!1),[B,H]=(0,m.useState)(""),[M,D]=(0,m.useState)([]),[P,z]=(0,w.Z)({}),randomRoomId=()=>Math.round(new Date().getMilliseconds()).toString(),[U,W]=(0,m.useState)(randomRoomId()),[q,X]=(0,C.Z)([]),Y=q.find(e=>e.players.some(e=>e.sid===B)),J=!!Y;(0,m.useEffect)(()=>(setTimeout(()=>{o.connected||i(!1)},2e3),X.clear(),o.on("connect",()=>{i(!0),console.log("Client Connected"),o.emit("list_roles",{},e=>{let{roles:t}=e;O(t)}),o.emit("list_rooms",{},e=>{let{rooms:t}=e;X.set(t)}),o.emit("info",{},e=>{console.log(e)}),o.emit("list_options",{},e=>{let{options:t}=e;D(t),z.setAll(Object.fromEntries(t.map(e=>[e.name,e.default])))})}),o.on("disconnect",()=>{i(!1),X.clear(),console.log("Client Disconnected")}),o.on("your_sid",e=>{let{sid:t}=e;H(t)}),o.onAny((e,t)=>{console.log(e,t)}),o.on("game_started",()=>{L(!0)}),o.on("room_changed",e=>{X.update(t=>t.room==e.room,e)}),o.on("room_created",e=>{let{room:t,owner_sid:s}=e;X.push({room:t,owner:s,in_game:!1,players:[]})}),o.on("room_deleted",e=>{let{room:t}=e;X.filter((e,s,a)=>e.room!=t)}),()=>{o.disconnect(),o.close()}),[o]),(0,F.Z)(()=>{a!==o.url&&(o.connected&&o.disconnect(),o.close(),i(null),n(createSocket(a)))},1e3,[a]),(0,F.Z)(()=>{(null==o?void 0:o.connected)&&o.emit("set_roles",{roles:[...R]})},500,[R]),(0,F.Z)(()=>{E&&(null==o?void 0:o.connected)&&o.emit("set_name",{name:E})},500,[E]);let[K,V]=(0,m.useState)(""),[$,Q]=(0,m.useState)("");return(0,c.jsxs)(c.Fragment,{children:[S||(0,c.jsxs)(p.Z,{children:[s&&(0,c.jsx)("h1",{className:"text-center m-2",children:s}),(0,c.jsxs)(N.Z,{className:"align-items-center m-2 g-3 justify-content-center",children:[(0,c.jsxs)(h.Z,{md:4,children:[(0,c.jsx)(v.Z.Label,{children:"Server URL"}),(0,c.jsxs)("div",{className:"position-relative",children:[(0,c.jsx)(v.Z.Control,{type:"text",placeholder:"Enter server URL",value:a,onChange:e=>r(e.target.value)}),(0,c.jsx)("div",{className:"end-0 position-absolute absolute-centered-y me-2",children:(0,c.jsx)(indicator,{status:(null==o?void 0:o.url)===a?l:null})})]})]}),(0,c.jsxs)(h.Z,{md:2,children:[(0,c.jsx)(v.Z.Label,{children:"Username"}),(0,c.jsx)(v.Z.Control,{type:"text",placeholder:"Enter username",value:E,onChange:e=>k(e.target.value),maxLength:23})]})]}),(0,c.jsx)("h3",{className:"text-center my-3",children:"Rooms"}),(0,c.jsxs)(N.Z,{className:"g-3 justify-content-center",children:[q.map(e=>{let t=e.players.some(e=>e.sid===B),s=e.owner===B;return(0,c.jsx)(h.Z,{md:4,children:(0,c.jsxs)(u.Z,{className:"text-center p-3 d-flex flex-column h-100 shadow-sm justify-content-between",children:[(0,c.jsxs)("h5",{children:["#",e.room]}),e.players.map(e=>(0,c.jsxs)("div",{className:"d-flex justify-content-center align-items-center my-2",children:[e.name,e.sid===B?(0,c.jsxs)(x.Z,{autoClose:"outside",className:"ms-2",children:[(0,c.jsx)(y.Z,{size:"sm",className:"text-wrap",children:[...R].sort().map(e=>A[e].name).join(", ")||"No Roles"}),(0,c.jsx)(_.Z,{className:"py-0",children:A.map((e,t)=>(0,c.jsxs)(g.Z,{active:I.has(t),className:"my-2 rounded-2",onClick:()=>I.has(t)?I.remove(t):I.add(t),children:[e.name," (min ",e.min,", max ",e.max,")"]},t))})]}):(0,c.jsxs)(c.Fragment,{children:[" ","(",e.roles.sort().map(e=>A[e].name).join(", ")||"No Roles",")"]})]},e.name)),!t&&(0,c.jsx)(d.Z,{size:"sm",className:"w-50 mt-3 mx-auto",variant:"primary",onClick:()=>{o.emit("join_room",{room:e.room,username:E||null}),o.emit("set_roles",{roles:[...R]})},disabled:e.in_game,children:e.in_game?"In Game":"Join"}),t&&(0,c.jsx)(d.Z,{size:"sm",className:"w-50 mt-3 mx-auto",variant:"danger",onClick:()=>o.emit("leave_room",{}),children:"Leave"}),s&&t&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d.Z,{size:"sm",className:"w-50 mt-3 mx-auto",variant:"success",onClick:()=>{console.log(P),o.emit("set_roles",{roles:[...R]}),o.emit("start_game",{args:{...P,players:T().chain(e.players).flatMap(e=>e.roles).uniq().value().length}},function(){let{error:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&(V(T().startCase(e.type)),Q(e.message||""))})},children:"Start Game"}),(null==M?void 0:M.length)&&(0,c.jsxs)(x.Z,{className:"mt-3",autoClose:"outside",children:[(0,c.jsx)(y.Z,{size:"sm",variant:"outline-primary",className:"border-0 text-body",children:"Options"}),(0,c.jsx)(_.Z,{children:M.filter(e=>!!e.description).map((e,t)=>(0,c.jsx)(j.Z,{children:(0,c.jsxs)(N.Z,{className:"row-cols-2",children:[(0,c.jsx)(h.Z,{xs:"auto",className:"me-auto d-flex align-items-center",children:e.name}),(0,c.jsx)(h.Z,{xs:"auto",children:"bool"===e.type?(0,c.jsx)(d.Z,{size:"sm",variant:!0==z.get(e.name)?"success":"danger",onClick:()=>z.set(e.name,!z.get(e.name)),children:!0==z.get(e.name)?"True":"False"}):(0,c.jsx)(v.Z.Control,{size:"sm",className:"w-50 ms-auto",value:String(z.get(e.name)),type:"str"===e.type?"text":"number",onChange:t=>z.set(e.name,getOptionValue(e,t.target.value))})}),(0,c.jsx)(h.Z,{xs:"auto",className:"text-black-50",children:e.description})]})},t))})]})]}),0===e.players.length&&(0,c.jsx)(d.Z,{size:"sm",className:"w-50 mt-3 mx-auto",variant:"danger",onClick:()=>o.emit("delete_room",{room:e.room}),children:"Delete"})]})},e.room)}),!J&&(0,c.jsx)(h.Z,{md:4,className:"text-center",children:(0,c.jsxs)("div",{className:"text-center p-3 d-flex flex-column h-100 justify-content-between",children:[(0,c.jsx)(v.Z.Label,{children:"Room ID"}),(0,c.jsx)(v.Z.Control,{className:"w-25 mx-auto mb-3 text-center",type:"text",placeholder:"Room ID",value:U,onChange:e=>W(e.target.value),maxLength:4}),(0,c.jsx)(d.Z,{className:"w-50 mx-auto",size:"sm",variant:"primary",onClick:()=>{o.emit("create_room",{room:U}),o.emit("join_room",{room:U,username:E||"Client"}),W(randomRoomId())},disabled:!0!==l||J,children:"Create"})]})})]})]}),(0,c.jsx)(G.Provider,{value:{socket:o,serverUrl:a,isConnected:l,roleInfo:A,currentRoom:Y,myRoles:[...R],leaveGame:()=>{L(!1),I.reset(),o.emit("leave_room",{})}},children:t}),(0,c.jsxs)(f.Z,{show:!!$,onHide:()=>Q(""),children:[(0,c.jsx)(f.Z.Header,{closeButton:!0,children:(0,c.jsx)(f.Z.Title,{children:K||"Error"})}),(0,c.jsx)(f.Z.Body,{children:(0,c.jsx)("p",{children:$})})]})]})};var I=s(7176);(a=n||(n={}))[a.EXPLOIT=0]="EXPLOIT",a[a.HEAL=1]="HEAL",a[a.FOREIGN_AID=2]="FOREIGN_AID",a[a.CLIMATE_GHOST=3]="CLIMATE_GHOST",a[a.END_TURN=4]="END_TURN",a[a.RENAME_REGION=5]="RENAME_REGION";var S=s(7769),L=s(3967),B=s.n(L),H=s(619),selected_region_panel=e=>{let{className:t}=e,{socket:s,myRoles:a}=(0,m.useContext)(G),{state:r,currentRegion:o,selectedRegion:l,currentPlayer:i,myTurn:p,operators:x,nameForPlayer:g,gameOver:j}=(0,m.useContext)(V),[_]=(0,H.Z)("/earth-health-game/audio/EarthHealthExploit.mp3"),[y]=(0,H.Z)("/earth-health-game/audio/EarthHealthHeal.mp3");return o&&(0,c.jsxs)(u.Z,{className:B()("shadow-lg w-25 p-3 pointer-events-auto",t),children:[(0,c.jsxs)("h2",{className:"text-center",children:[o.name,a.includes(o.current_player)&&(0,c.jsx)(d.Z,{size:"sm",variant:"outline-primary",className:"border-0",onClick:()=>{let e=prompt("Choose a new name for this region",o.name);e&&e!==o.name&&s.emit("operator_chosen",{op_no:n.RENAME_REGION,params:[o.id,e]})},children:(0,c.jsx)(S.Z,{})})]}),(0,c.jsxs)(N.Z,{className:"fs-5 g-2 row-cols-2",children:[o.health>0&&(0,c.jsxs)(h.Z,{children:["Owned by: ",g(o.current_player)]}),(0,c.jsxs)(h.Z,{children:["Biome: ",o.biome,$.biome[o.biome].emoji]}),(0,c.jsxs)(h.Z,{children:["Health:"," ",o.health>0?"".concat(o.health,"❤️"):"\uD83D\uDC80"]})]}),!j&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h3",{className:"text-center",children:"Actions"}),(0,c.jsxs)(N.Z,{className:"row-cols-1 g-2 justify-content-center",children:[!p&&(0,c.jsx)(h.Z,{children:"Not your turn."}),o.id in i.current_actions?(0,c.jsx)(h.Z,{children:"Already taken action this turn."}):(0,c.jsx)(c.Fragment,{children:x.filter(e=>{switch(e.op_no){case n.EXPLOIT:case n.HEAL:return o.current_player==r.current_player;case n.FOREIGN_AID:return o.health>0&&o.current_player!==r.current_player;default:return!1}}).map(e=>(0,c.jsx)(h.Z,{xs:"auto",children:(0,c.jsx)(d.Z,{onClick:()=>{switch(s.emit("operator_chosen",{op_no:e.op_no,params:[l]}),e.op_no){case n.HEAL:y();break;case n.EXPLOIT:_()}},children:e.name})}))})]})]})]})},end_turn_panel=e=>{let{className:t}=e,{socket:s,leaveGame:a}=(0,m.useContext)(G),{state:r,currentPlayer:o,operators:l,nameForPlayer:i,gameOver:h}=(0,m.useContext)(V),p=l.find(e=>e.op_no===n.CLIMATE_GHOST);return(0,c.jsx)(u.Z,{className:B()("shadow-lg w-auto p-3",t),children:(0,c.jsx)("h3",{className:"text-center pointer-events-auto",children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{children:"The Game Is Over!"}),(0,c.jsx)(d.Z,{className:"mt-3 w-100",onClick:()=>null==a?void 0:a(),children:"Return Home"})]}):l.length>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{children:"It is your turn."}),p&&(0,c.jsx)(d.Z,{className:"mt-3 w-100",variant:"warning",onClick:()=>s.emit("operator_chosen",{op_no:n.CLIMATE_GHOST,params:null}),children:p.name}),(0,c.jsx)(d.Z,{className:"mt-3 w-100",variant:r.world.regions.some(e=>e.current_player===r.current_player&&!(e.id in o.current_actions))?"primary":"success",onClick:()=>s.emit("operator_chosen",{op_no:n.END_TURN,params:null}),children:"End Turn"})]}):"".concat(i(r.current_player)," is acting.")})})};(r=l||(l={})).RED="#C0392B",r.GREEN="#27AE60",r.YELLOW="#F1C40F",r.BLUE="#2980B9",r.MAGENTA="#8E44AD",r.CYAN="#17C4C4",r.WHITE="#ECF0F1",r.ORANGE="#E67E22",r.PURPLE="#9B59B6";let M={91:"#C0392B",92:"#27AE60",93:"#F1C40F",94:"#2980B9",95:"#8E44AD",96:"#17C4C4",97:"#ECF0F1",33:"#E67E22",105:"#9B59B6"},ansiToHtml=e=>(e=(e=e.replace(/\x1b\[(\d+)m/g,(e,t)=>{let s=M[t];return s?'<span style="color:'.concat(s,'">'):"0"===t?"</span>":e})).replace(/\n/g,"<br><br>"),"<div>".concat(e,"</div>")),biomeColor=e=>l[$.biome[e].color],playerColor=e=>l[$.player_colors[e]];var D=s(5472),P=s.n(D),state_info_panel=e=>{let{className:t}=e,{myRoles:s}=(0,m.useContext)(G),{state:a,nameForPlayer:r}=(0,m.useContext)(V);return(0,c.jsxs)(u.Z,{className:B()("shadow-lg w-25 p-3 overflow-y-auto pointer-events-auto",t),style:{maxHeight:"80vh"},children:[(0,c.jsx)("h3",{className:"text-center",children:"State Info"}),(0,c.jsxs)(N.Z,{className:"row-cols-1 g-2",children:[(0,c.jsxs)(h.Z,{children:["Time: ",displayTime(a.time)]}),(0,c.jsxs)(h.Z,{children:["Climate Badness: ",a.global_badness]})]}),a.players.some(e=>s.includes(e.player_id)&&e.regions_owned<=0)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h3",{className:"text-center my-3",children:"Next Possible Disasters"}),(0,c.jsx)(N.Z,{className:"row-cols-1 g-3",children:a.disaster_buffer.map((e,t)=>{let s=a.world.regions[e.region_id];return(0,c.jsxs)(h.Z,{children:[$.disaster[e.disaster].emoji,e.disaster," in ",$.biome[s.biome].emoji,s.name]},t)})})]}),(0,c.jsx)("h3",{className:"text-center my-3",children:"Player Info"}),(0,c.jsx)(N.Z,{className:"row-cols-1 g-3",children:P()(a.players,e=>!s.includes(e.player_id)).map(e=>(0,c.jsx)(h.Z,{children:(0,c.jsxs)(N.Z,{className:"row-cols-1 p-2 g-2 rounded-2",style:{border:".5rem ".concat(playerColor(e.player_id)," solid")},children:[(0,c.jsxs)(h.Z,{children:[r(e.player_id),": ",displayMoney(e.money)]}),Object.values(a.world.regions).filter(t=>t.current_player===e.player_id).map((e,t)=>(0,c.jsxs)(h.Z,{className:"ms-4",children:[e.name," (",e.biome,$.biome[e.biome].emoji,", ",e.health,"❤️)"]},t))]})},e.player_id))})]})};(o=i||(i={})).ByOwner="By Owner",o.ByBiome="By Biome",o.ByHealth="By Health";var visual_options_panel=e=>{let{className:t}=e,{options:{colorMode:s,setColorMode:a}}=(0,m.useContext)(V);return(0,c.jsx)(u.Z,{className:B()("position-absolute shadow-lg w-auto p-3",t),children:(0,c.jsx)(N.Z,{className:"row-cols-1 g-3 pointer-events-auto",children:(0,c.jsxs)(h.Z,{className:"d-flex flex-row align-items-center",children:[(0,c.jsx)("span",{className:"me-3",children:"Region Color Mode"}),(0,c.jsxs)(x.Z,{children:[(0,c.jsx)(y.Z,{size:"sm",children:s}),(0,c.jsx)(_.Z,{children:Object.values(i).map(e=>(0,c.jsx)(g.Z,{active:e===s,onClick:()=>a(e),children:e},e))})]})]})})})},transitions_model=e=>{let{text:t,title:s,onHide:a}=e;return(0,c.jsxs)(f.Z,{size:"lg",show:!!t,onHide:a,backdrop:"static",className:"user-select-none",children:[(0,c.jsx)(f.Z.Header,{closeButton:!0,children:(0,c.jsx)(f.Z.Title,{children:s})}),(0,c.jsx)(f.Z.Body,{children:(0,c.jsx)("p",{dangerouslySetInnerHTML:{__html:ansiToHtml(t||"")}})})]})},z=s(7172),U=s(6409),W=s(5929),q=s(9591),region_geography=e=>{let{geo:t}=e,{state:s,selectedRegion:a,setSelectedRegion:r,myTurn:o,currentPlayer:n,options:{colorMode:d}}=(0,m.useContext)(V),u=regionForGeo(t,s),h="#666";if(u.health>0)switch(d){case i.ByBiome:h=biomeColor(u.biome);break;case i.ByOwner:h=playerColor(u.current_player);break;case i.ByHealth:h=(0,W.Z)(l.RED,l.GREEN)(u.health/10)}let p=u.id===a,x=o&&u.current_player===s.current_player&&!(u.id in n.current_actions)&&u.health>0;return(0,c.jsx)(z.Geography,{geography:t,fill:h,style:{default:{stroke:p?"#FFF":x?"#0F0":"#666",strokeWidth:1,outline:"none"},hover:{stroke:p?"#FFF":x?"#0F0":"#666",strokeWidth:1,fill:(0,q.ZP)(h,"#FFF")(.2),outline:"none"}},onClick:e=>{e.stopPropagation(),r(p?-1:u.id)}})},X=s(8540),region_marker=e=>{let{geo:t}=e,{state:s}=(0,m.useContext)(V),a=regionForGeo(t,s),r=(0,X.Z)(t);return(0,c.jsxs)(z.Marker,{coordinates:r,className:"pointer-events-none",children:[(0,c.jsx)("text",{textAnchor:"middle",y:-2,style:{fontFamily:"system-ui",fontWeight:"bold",fontSize:5,fill:"#000"},stroke:"#FFF",strokeWidth:.2,children:a.name}),(0,c.jsx)("text",{textAnchor:"middle",y:4,style:{fontFamily:"system-ui",fontWeight:"bold",fontSize:5,fill:"#000"},stroke:"#FFF",strokeWidth:.2,children:a.health>0?(0,c.jsxs)(c.Fragment,{children:[a.health,"❤️",$.biome[a.biome].emoji]}):(0,c.jsx)(c.Fragment,{children:"\uD83D\uDC80"})})]})};let regionForGeo=(e,t)=>{let s=parseInt(e.rsmKey.replace("geo-",""));return t.world.regions[s]};var game_map=()=>{let e=(0,U.g)()||1e3,{state:t,currentPlayer:s,selectedRegion:a,setSelectedRegion:r}=(0,m.useContext)(V),reorderGeos=e=>T().chain(e).filter((e,s)=>s<t.world.region_count).orderBy([e=>regionForGeo(e,t).id===a,e=>regionForGeo(e,t).current_player===t.current_player,e=>!(regionForGeo(e,t).id in s.current_actions)]).value();return(0,c.jsx)(z.ComposableMap,{height:1e3,width:2e3,style:{background:l.BLUE,height:e,width:"100%"},onClick:()=>r(-1),children:(0,c.jsx)(z.ZoomableGroup,{zoom:4,minZoom:3,translateExtent:[[600,300],[1300,700]],children:(0,c.jsx)(z.Geographies,{geography:"/earth-health-game/map.geo.json",children:e=>{let{geographies:t}=e,s=reorderGeos(t);return s.map(e=>(0,c.jsx)(region_geography,{geo:e},e.rsmKey+"Geography")).concat(s.map(e=>(0,c.jsx)(region_marker,{geo:e},e.rsmKey+"Marker")))}})})})};let logMessageForOperator=(e,t,s)=>{let a="".concat(t," has ");switch(e.op_no){case n.EXPLOIT:case n.HEAL:case n.FOREIGN_AID:case n.RENAME_REGION:let r=s.world.regions[e.params[0]];switch(e.op_no){case n.EXPLOIT:a+="exploited ".concat(r.name,".");break;case n.HEAL:a+="healed ".concat(r.name,".");break;case n.FOREIGN_AID:a+="sent foreign aid to ".concat(r.name,".");break;case n.RENAME_REGION:a+="renamed ".concat(r.name," to ").concat(e.params[1],".")}break;case n.CLIMATE_GHOST:a+="has tipped the scales from beyond the grave.";break;case n.END_TURN:a+="ended their turn."}return a},logsForTransitions=(e,t)=>{let s=[];if(!e||e.time===t.time)return s;for(let e of t.devastations)s.push({time:t.time,message:"".concat(e.disaster," in ").concat(e.region," (").concat(e.damage," damage)")});for(let r of t.world.regions){var a;r.health<=0&&(null!==(a=null==e?void 0:e.world.regions[r.id].health)&&void 0!==a?a:0)>0&&s.push({time:t.time,message:"".concat(r.name," was destroyed!")})}return s};var game_log_panel=e=>{let{className:t,gameLogs:s}=e,[a,r]=(0,m.useState)(!1);return(0,c.jsxs)("div",{className:B()("w-50 h-25",t),children:[a&&(0,c.jsx)(u.Z,{className:"shadow-lg p-3 mb-5 h-100 overflow-y-scroll w-100 bottom-0 position-absolute d-flex flex-column-reverse pointer-events-auto",children:(0,c.jsx)("table",{children:P()(s,e=>e.time).map((e,t)=>{let{time:s,message:a}=e;return(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:displayTime(s)}),(0,c.jsx)("td",{children:a})]},t)})})}),(0,c.jsx)(d.Z,{variant:"outline-dark",className:"border-0 fs-4 pointer-events-auto bottom-0 position-absolute absolute-centered-x",onClick:()=>r(!a),children:"Logs"})]})},Y=JSON.parse('{"biomes":[{"name":"Ocean","color":"BLUE","playable":false,"emoji":"\uD83C\uDF0A","disaster_matrix":{"earthquake":0,"fire":0,"flood":0,"windstorm":0}},{"name":"Mountain","color":"CYAN","playable":true,"emoji":"⛰️","disaster_matrix":{"earthquake":1,"fire":-1,"flood":-2,"windstorm":2}},{"name":"Plains","color":"YELLOW","playable":true,"emoji":"\uD83C\uDF3E","disaster_matrix":{"earthquake":2,"fire":1,"flood":2,"windstorm":-1}},{"name":"Woods","color":"GREEN","playable":true,"emoji":"\uD83C\uDF32","disaster_matrix":{"earthquake":-1,"fire":2,"flood":1,"windstorm":-2}},{"name":"Mesa","color":"RED","playable":true,"emoji":"\uD83C\uDFDC️","disaster_matrix":{"earthquake":2,"fire":-2,"flood":-1,"windstorm":1}}],"disasters":[{"name":"Earthquake","color":"GREEN","damage":4,"emoji":"\uD83E\uDEA8","disaster_matrix":{"fire":1}},{"name":"Fire","color":"RED","damage":4,"emoji":"\uD83D\uDD25","disaster_matrix":{"flood":-1,"windstorm":2,"earthquake":1}},{"name":"Flood","color":"BLUE","damage":4,"emoji":"\uD83C\uDF0A","disaster_matrix":{"fire":-1}},{"name":"Windstorm","color":"YELLOW","damage":4,"emoji":"\uD83C\uDF2A️","disaster_matrix":{"fire":2}}],"disaster_combos":[{"name":"Fireflood","disasters":["fire","flood"],"effect":-1},{"name":"Firestorm","disasters":["fire","windstorm"],"effect":2},{"name":"Firequake","disasters":["fire","earthquake"],"effect":1}],"player_colors":["RED","GREEN","MAGENTA","ORANGE","CYAN"],"adjacency":{"0":[6,7,12,14],"1":[3,5,18],"2":[19],"3":[1,5,8,13,16],"4":[8,15,16],"5":[1,3,13,17],"6":[0,7,12,15],"7":[0,6,10,13,14,15],"8":[3,4,10,13,15,16],"9":[19],"10":[7,8,13,15],"11":[16],"12":[0,6],"13":[3,5,7,8,10,14,17],"14":[0,7,13],"15":[4,6,7,8,10],"16":[3,4,8,11],"17":[5,13],"18":[1,19],"19":[2,9,18]},"names":["Nova Arcadia","Elysium","Astoria","Aetheria","Valoria","Xion","Seraphina","Atlantica","Zirvana","Avalon","Galadria","Mythos","Ytopia","Elysian Fields","Aurora","Celestia","Elympia","Excalibur","Aden","Arcadia"]}'),J=s(4350),K=s.n(J),menu_panel=e=>{let{className:t}=e,{leaveGame:s}=(0,m.useContext)(G);return(0,c.jsx)("div",{className:B()(t),children:(0,c.jsxs)(x.Z,{drop:"down-centered",className:"pointer-events-auto",children:[(0,c.jsx)(y.Z,{variant:"outline-dark",className:"border-0 fs-4 d-flex align-items-center",children:"Menu"}),(0,c.jsx)(_.Z,{children:(0,c.jsx)(g.Z,{onClick:()=>{confirm("Are you sure you want to leave? This will end the game for other players.")&&(null==s||s())},children:"Leave Game"})})]})})};let displayTime=e=>2050+10*e,displayMoney=e=>"$".concat(e,"M"),V=(0,m.createContext)(void 0),$={...Y,biome:K()(Y.biomes,e=>e.name),disaster:K()(Y.disasters,e=>e.name),disasterCombo:K()(Y.disaster_combos,e=>e.name)};var game=()=>{let{socket:e,currentRoom:t,roleInfo:s,myRoles:a}=(0,m.useContext)(G),[r,o]=(0,m.useState)(void 0),[n,l]=(0,m.useState)([]),[d,u]=(0,m.useState)(!1),[h,p]=(0,m.useState)(-1),[x,g]=(0,C.Z)([]),[j,_]=(0,C.Z)([]),[y,v]=(0,m.useState)(void 0),[f,N]=(0,m.useState)(i.ByOwner),E=(0,m.useMemo)(()=>t&&s?s.map((e,s)=>{var a;return(null===(a=t.players.find(e=>e.roles.includes(s)))||void 0===a?void 0:a.name)||"Unknown"}):[],[t,s]),Z=h<0||!r?void 0:r.world.regions[h],b=null==r?void 0:r.players[null==r?void 0:r.current_player],w=!!r&&a.includes(r.current_player),nameForPlayer=e=>{var t;return"".concat(null==s?void 0:null===(t=s[e])||void 0===t?void 0:t.name," (").concat(E[e],")")},[F]=(0,H.Z)("/earth-health-game/audio/EarthHealthTurnStart.mp3"),k=(0,I.Z)(r);return(0,m.useEffect)(()=>{r&&(null==k?void 0:k.current_player)!==r.current_player&&a.includes(r.current_player)&&F()},[r,a]),(0,m.useEffect)(()=>{e&&(e.on("game_started",e=>{e.state&&(o(JSON.parse(e.state)),j.push({time:0,message:"The game has started!"}))}),e.on("operators_available",e=>{l(e.operators)}),e.on("operator_applied",e=>{e.state&&o(t=>{var s,a;v({...e.operator,player:null!==(s=null==t?void 0:t.current_player)&&void 0!==s?s:0,time:null!==(a=null==t?void 0:t.time)&&void 0!==a?a:0});let r=JSON.parse(e.state);return _.push(...logsForTransitions(t,r)),r})}),e.on("transition",e=>{let{message:t}=e;g.push(t)}),e.on("disconnect",()=>{r&&(alert("You have been disconnected from the server"),window.location.reload())}),e.on("room_left",e=>{let{username:t}=e;r&&(u(!0),g.push("".concat(t," has left the game! Reconnection has not yet been implemented, so unfortunately the game must end.")))}))},[e]),(0,m.useEffect)(()=>{y&&_.push({time:y.time,message:logMessageForOperator(y,nameForPlayer(y.player),r)})},[y]),(0,m.useEffect)(()=>{t||o(void 0)},[t]),(0,c.jsx)("div",{className:"h-auto user-select-none",children:r&&(0,c.jsx)(V.Provider,{value:{state:r,operators:n,namesByRole:E,selectedRegion:h,setSelectedRegion:p,currentRegion:Z,currentPlayer:b,myTurn:w,nameForPlayer,gameOver:d,options:{colorMode:f,setColorMode:N}},children:(0,c.jsxs)("div",{className:"overflow-hidden position-relative d-flex",children:[(0,c.jsx)(game_map,{}),(0,c.jsxs)("div",{className:"position-absolute w-100 h-100 pointer-events-none",children:[(0,c.jsx)(state_info_panel,{className:"position-absolute top-0 start-0 m-4"}),(0,c.jsx)(selected_region_panel,{className:"position-absolute top-0 end-0 m-4"}),(0,c.jsx)(end_turn_panel,{className:"position-absolute bottom-0 end-0 m-4"}),(0,c.jsx)(visual_options_panel,{className:"position-absolute bottom-0 start-0 m-4"}),(0,c.jsx)(game_log_panel,{className:"position-absolute bottom-0 absolute-centered-x m-4",gameLogs:j}),(0,c.jsx)(menu_panel,{className:"position-absolute top-0 absolute-centered-x m-4"}),(0,c.jsx)(transitions_model,{text:x.length>0?x[0]:void 0,title:d?"Game Over!":"Transition",onHide:()=>{g.removeAt(0)}})]})]})})})},pages=()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(SocketIOCommon,{title:"Collaborative Climate Contest",children:(0,c.jsx)(game,{})})})}},function(e){e.O(0,[662,695,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);